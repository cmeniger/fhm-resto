!function(t,a,n){function e(t){this.settings=t,this.init()}e.prototype={init:function(){this.initAnchor(),this.initModal(),this.initAction(),this.initFilter(),this.initForm()},initAnchor:function(){var a=this;t(a.settings.anchor.container).unbind("click").click(function(n){if(n.preventDefault(),t(this).hasClass("active"))return t(a.settings.anchor.container).removeClass("active"),t(".task-anchor").hide(),t(".task").css("opacity",1),!1;var e=t(".task-anchor[data-id="+t(this).attr("data-id")+"]"),o=e.attr("data-parent").split(","),s=e.attr("data-son").split(",");for(t(a.settings.anchor.container).removeClass("active"),t(".task-anchor").hide(),t(".task").css("opacity",.3),t(this).addClass("active"),e.removeClass("parent").removeClass("son").show(),t(".task[data-id="+t(this).attr("data-id")+"]").fadeTo("fast",1),i=0;i<o.length;i++)""!=o[i]&&(t(".task[data-id="+o[i]+"]").css("opacity",1),t(".task-anchor[data-id="+o[i]+"]").removeClass("son").addClass("parent").show());for(i=0;i<s.length;i++)""!=s[i]&&(t(".task[data-id="+s[i]+"]").css("opacity",1),t(".task-anchor[data-id="+s[i]+"]").removeClass("parent").addClass("son").show())})},initModal:function(){var i=this;t(i.settings.modal.action).unbind("click").click(function(e){e.preventDefault(),t.ajax({type:"POST",url:t(this).attr("data-url"),data:{},success:function(e){t(a).scrollTop(0),t(i.settings.modal.content).html(e),t(n).on("opened.fndtn.reveal","[data-reveal]",function(){"undefined"!=typeof modalOpen&&modalOpen()}),t(n).on("closed.fndtn.reveal","[data-reveal]",function(){"undefined"!=typeof modalClose&&modalClose()}),t(i.settings.modal.container).foundation("reveal","open"),i.initModal(),i.initFilter(),i.initForm()}})})},initAction:function(){var a=this;t(a.settings.action.container).unbind("click").click(function(i){i.preventDefault();var n=t(this);t.ajax({type:"POST",url:t(this).attr("data-url"),data:{},success:function(i){n.attr("data-step")?t.ajax({type:"POST",url:n.attr("data-step"),data:{},success:function(i){t(a.settings.action.step).fadeToggle(400,"linear",function(){t(a.settings.action.step).html(i).fadeToggle(400,"linear"),a.initModal(),a.initAction()})}}):t(a.settings.action.data).fadeToggle(400,"linear",function(){t(a.settings.action.data).html(a.getHtml(i,a.settings.action.data)).fadeToggle(400,"linear"),a.initAnchor(),a.initModal(),a.initAction()})}})})},initFilter:function(){var a=this;t(a.settings.filter.container).unbind("click").click(function(a){a.preventDefault(),t(this).hasClass("deactivate")?(t(this).removeClass("deactivate"),t("div[data-log="+t(this).attr("data-filter")+"]").fadeIn()):(t(this).addClass("deactivate"),t("div[data-log="+t(this).attr("data-filter")+"]").fadeOut())})},initForm:function(){var a=this;t(a.settings.form.container).submit(function(i){i.preventDefault(),t.ajax({type:"POST",url:t(this).attr("action"),data:t(this).serialize(),success:function(i){t(a.settings.modal.content).fadeToggle(400,"linear",function(){"undefined"!=typeof modalClose&&modalClose(),t(a.settings.modal.content).html(i).fadeToggle(400,"linear",function(){"undefined"!=typeof modalOpen&&modalOpen()}),a.initModal(),a.initFilter(),a.initForm()})}})})},refresh:function(){},getHtml:function(a,i){var n=t(t.parseHTML(a));return n.filter(i).add(n.find(i)).html()}},t.fn.workflow=function(a){var i=t.extend({container:".workflow",modal:{container:"#wfModal",content:"#wfModalContent",action:".workflow a[data-modal]"},anchor:{container:".workflow a[data-anchor]"},action:{container:".workflow a[data-action]",data:"#wfCanvas",step:"#wfStep"},filter:{container:".workflow div[data-filter]"},form:{container:".workflow form:not(.dropzone)"}},a);new e(i)}}(jQuery,window,window.document);